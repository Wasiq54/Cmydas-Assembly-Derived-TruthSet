# Methods

## Overview

This repository documents a complete, reproducible workflow for short‑read whole‑genome analysis of the green sea turtle (*Chelonia mydas*). The pipeline covers read quality control and trimming, de novo genome assembly, assembly quality evaluation (QUAST, BUSCO, ANI), reference‑guided alignment, variant calling, filtering and benchmarking with RTG vcfeval. All commands, scripts, and intermediate results are preserved to ensure full reproducibility.

---

## Software and Tool Versions

All analyses were conducted using isolated Conda or Docker environments with stable releases available in 2025.

* DeepVariant **v1.9.0**
* GATK **v4.6.2.0** (Picard **v3.4.0**, HTSJDK **v4.2.0**)
* FreeBayes **v1.3.10**
* VarScan **v2.4.6**
* BCFtools **v1.22** (HTSlib **v1.22.1**)
* Samtools **v1.22.1**
* BWA‑MEM **v0.7.17**
* Bowtie2 **v2.5.2**
* Minimap2 **v2.28**
* RTG Tools **v3.12.1**
* FastQC **v0.11.9**
* MultiQC **v1.15**
* fastp **v0.23.4**
* seqkit **v2.8.2**
* SOAPdenovo2 **v2.40**
* ABySS **v2.3.6**
* MEGAHIT **v1.2.9**

---

## Sequencing Data

### Sample description

Paired‑end Illumina NovaSeq 6000 reads (151 bp) for the normal *Chelonia mydas* sample **CH‑NORMS1** were generated by **Macrogen Singapore** using the **TruSeq Nano DNA** library preparation kit.

### Raw read summary

| Dataset            | File            |     Encoding | Total sequences | Total bases | Read length | %GC | Poor‑quality reads |
| ------------------ | --------------- | -----------: | --------------: | ----------: | ----------: | --: | -----------------: |
| Normal (CH‑NORMS1) | W1‑A_1.fastq.gz | Illumina 1.9 |     456,923,725 |    68.9 Gbp |      151 bp |  44 |                  0 |
| Normal (CH‑NORMS1) | W1‑A_2.fastq.gz | Illumina 1.9 |     456,923,725 |    68.9 Gbp |      151 bp |  45 |                  0 |

---

## Read Quality Control

Initial quality assessment was performed using FastQC, and reports were aggregated using MultiQC.

```bash
fastqc --threads 16 W1-A_1.fastq.gz W1-A_2.fastq.gz -o CH-NORMS1/FastqcReport
multiqc CH-NORMS1/FastqcReport -o CH-NORMS1/MultiQC_raw
```

The raw data showed uniform per‑base quality, no adapter contamination, and GC content (~44%) consistent with the *C. mydas* genome.

---

## Read Trimming

Reads were trimmed using **fastp** to remove adapters and low‑quality bases while preserving paired‑end consistency.

* Trimming commands: `scripts/commands_trimming.txt`

### Trimmed read summary

| Dataset            | File                    |     Encoding | Total sequences | Total bases | Read length | %GC | Poor‑quality reads |
| ------------------ | ----------------------- | -----------: | --------------: | ----------: | ----------: | --: | -----------------: |
| Normal (CH‑NORMS1) | W1‑A_1_trimmed.fastq.gz | Illumina 1.9 |     438,509,696 |      66 Gbp |   15–151 bp |  44 |                  0 |
| Normal (CH‑NORMS1) | W1‑A_2_trimmed.fastq.gz | Illumina 1.9 |     438,509,696 |      66 Gbp |   15–151 bp |  44 |                  0 |

Post‑trimming quality was re‑validated using FastQC and MultiQC.

---

## De novo Genome Assembly

Trimmed reads from the normal dataset were assembled using three short‑read assemblers:

1. **ABySS**
2. **MEGAHIT**
3. **SOAPdenovo2**

All commands and parameters are provided in:

* `script/Denovo_and_Trth_set_Steps_and_Commands.txt`

---

## Assembly Evaluation

### QUAST

Assembly contiguity and fragmentation were assessed using QUAST, reporting total length, N50/N90, L50/L90, contig counts, GC content, and ambiguous bases.

* Output: `Results/QUAST_report.pdf`

### BUSCO

Gene‑space completeness was evaluated using BUSCO with a reptile‑appropriate lineage dataset.

* Summary: `Results/Busco_and_ANI_Results.txt`

### ANI

Average Nucleotide Identity (ANI) between each assembly and the NCBI reference genome was computed using **skani**.

```bash
skani dist -q Reference/Reference.fasta -r <assembly.fa> -t 30 > <ani_result.txt>
```

---

## Reference‑Guided Alignment

Trimmed reads were aligned to the chromosome‑level reference genome **rCheMyd1.pri.v2 (GCA_015237465.2)** using three aligners:

* BWA‑MEM
* Bowtie2
* Minimap2

Sorted and indexed BAM files were generated using Samtools. Mapping statistics were evaluated using `samtools flagstat`.

* Commands: `scripts/commands_alignment.txt`
* Results: `Results/*flagstat.txt`

Duplicate reads were marked using GATK MarkDuplicates prior to variant calling.

---

## Variant Calling

Variants (SNPs and indels) were detected from BWA‑MEM–aligned reads using five tools:

* DeepVariant
* GATK HaplotypeCaller
* FreeBayes
* VarScan
* BCFtools

Commands are documented in:

* `scripts/commands_variant_calling.txt`

### Raw variant counts (Normal sample)

| Tool        | Total variants |
| ----------- | -------------: |
| BCFtools    |     14,327,393 |
| DeepVariant |     17,425,142 |
| FreeBayes   |     13,910,723 |
| GATK        |     14,632,668 |
| VarScan     |     13,762,684 |

---

## Variant Filtering

Variants were retained if they:

1. Passed internal filters (FILTER = PASS or “.”)
2. Had alternate allele depth (AD) > 3
3. Had variant allele frequency (VAF) > 0.02

Filtering scripts:

* `scripts/filter_all_tools.sh`

### Filtered variant counts (Normal sample)

| Tool        | Total variants |
| ----------- | -------------: |
| BCFtools    |     14,220,913 |
| DeepVariant |     13,705,037 |
| FreeBayes   |     13,239,802 |
| GATK        |     14,467,559 |
| VarScan     |     13,753,976 |

---

## SNP‑Only Datasets

SNP‑only VCFs were generated for downstream benchmarking and concordance analysis.

Scripts:

* `scripts/make_snps.sh`

| File               |  SNP count |
| ------------------ | ---------: |
| BCF_normal         | 12,678,209 |
| DeepVariant_normal | 12,058,893 |
| FreeBayes_normal   | 11,247,911 |
| GATK_normal        | 12,629,773 |
| VarScan_normal     | 12,228,987 |

---

## Benchmarking with RTG vcfeval

Variant calling performance was evaluated using RTG vcfeval against the assembly‑derived truth set.

* Commands: `script/RTG.txt`

Both unfiltered and best‑score (threshold‑optimized) performance metrics were computed, including precision, sensitivity, and F1‑score.

---


## Reproducibility

All scripts, commands, and result files referenced above are included in this repository. Directory paths and filenames are preserved exactly as used in the analysis to facilitate direct reproduction of results.

---

## Data Availability and Inputs/Outputs

### Raw sequencing data

Raw whole-genome Illumina NovaSeq 6000 sequencing data (151 bp paired-end) for the *Chelonia mydas* normal individual **CH-NORMS1** are publicly available in the **European Nucleotide Archive (ENA)** under the study accession **PRJEB104518**:
[https://www.ebi.ac.uk/ena/browser/view/PRJEB104518](https://www.ebi.ac.uk/ena/browser/view/PRJEB104518)

### Reference genome

The chromosome-level reference genome used for read alignment and comparative analyses, **rCheMyd1.pri.v2 (GCA_015237465.2)**, was obtained from **NCBI RefSeq** as part of the **Vertebrate Genomes Project (VGP)** and is publicly accessible.

### Scripts and workflows

All scripts and command files used for read preprocessing, trimming, de novo genome assembly, assembly evaluation, reference-based alignment, variant calling, filtering, benchmarking, and concordance analysis are available in the public GitHub repository:
[https://github.com/FahadAslam988/Cmydas-Assembly-Derived-TruthSet](https://github.com/FahadAslam988/Cmydas-Assembly-Derived-TruthSet)

### Processed data outputs

Processed data generated in this study, including:

* De novo assemblies (ABySS, MEGAHIT, SOAPdenovo2)
* QUAST, BUSCO, and ANI evaluation summaries
* Assembly-derived SNP truth set
* Filtered VCF files from all variant calling tools

are archived on **Zenodo** under the DOI:
**10.5281/zenodo.17741557**

This ensures long-term accessibility, transparency, and full reproducibility of all analyses presented in this repository.
